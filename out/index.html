<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Home</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Home</h1>

    



    


    <h3> </h3>










    




    <section>
        <article><h1>dingsda</h1><p>dingsda - ze internez of dings</p>
<p>https://<a href="http://www.dingsda.org">www.dingsda.org</a></p>
<p>test web UI (optimized for mobile): https://<a href="http://www.dingsda.org/two">www.dingsda.org/two</a></p>
<p>at the moment: invite only. Feel welcome to contact philip(_Ã¤t_)machinaex(<em>dot</em>)de to get a test account.</p>
<h2>documentation</h2><p>function documentation (so far only of server.js not yet from the clients) can
be found at https://dingsda.org/docs/</p>
<h2>API v0.1</h2><p>HTTP API running from node script:</p>
<p> <em>server.js</em>:</p>
<p><strong>known issues</strong></p>
<ul>
<li>not propper RESTful API because commands part of JSON payload instead of url endpoint. will be changed till v1.0.0, but atm not hightest priority (sorry, noob mistake)</li>
</ul>
<p><strong>dependencies:</strong></p>
<ul>
<li>nano (^7.1.0)</li>
<li>https (^1.0.0)</li>
<li>express (^4.16.4)</li>
<li>request (^2.88.0)</li>
<li>cookie-parser (^1.4.3)</li>
<li>body-parser (^1.18.3)</li>
<li>uuid/v5 // npm install uuid (^3.3.2)</li>
<li>cors (^2.8.4)</li>
<li><p>http-proxy (^1.17.0)</p>
</li>
<li><p>web-push (^2.88.0) (not yet implemented but used in pushServer_test)</p>
</li>
</ul>
<p><strong>configuration</strong></p>
<p>configuration for server.js and pushServer_test is to be found within the config_file server_config.json</p>
<p>configuration for the UIs is found inside of UI/<ui number>/config_UI.json</p>
<p>please provide all necessary information before you start the server.</p>
<p><strong>HTTP API</strong></p>
<p>the dingsda API knows <strong>3 different entry levels:</strong></p>
<ol>
<li><p><strong>Instance Level</strong> (http requests to URL instanceUrl + API_BASE_URL will be considered Instance Level and handled within server.js by the function <strong><a href="https://dingsda.org/docs/global.html#instanceCommander">instanceCommander()</a></strong>)
for example: https://dingsda.org:3000/api/v1</p>
</li>
<li><p><strong>Database Level</strong> (http requests to URL instanceUrl + API_BASE_URL + <username> will be considered DB level and handled by function <strong><a href="https://dingsda.org/docs/global.html#DBCommander">DBCommander()</a></strong>)
for example: https://dingsda.org:3000/api/v1/machinaex</p>
</li>
<li><p><strong>Ding Level</strong> (http requests to URL instanceURL + API_BASE_URL + <username> + <item _id> will be considered dinglevel and be handled by function <strong><a href="https://dingsda.org/docs/global.html#dingsCommander">dingsCommander()</a></strong>)
for example: https://dingsda.org:3000/api/v1/machinaex/29e5cf8f-a99c-571c-93ab-e24fad18d2be</p>
</li>
</ol>
<p>requests to API need AuthSessionToken within its cookies all times except for Authentication.</p>
<p>Important: <strong>All POST API endpoints</strong> MUST be <strong>JSON formatted</strong> and follow this
basic form:</p>
<pre class="prettyprint source lang-json"><code>{
  &quot;data&quot;:[
    {
      &quot;type&quot;:&quot;&lt;name of command type>&quot;,
      &quot;&lt;other fields>&quot;: {}
    }
  ]
}</code></pre><h3>1. Instance Level API</h3><h4>GET:</h4><h6>Authentication:</h6><table>
<thead>
<tr>
<th>parameter</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>username to authenticate with</td>
</tr>
<tr>
<td>password</td>
<td>password</td>
</tr>
</tbody>
</table>
<p>see: <a href="https://dingsda.org/docs/global.html#verifyUserCredibility">verifyUserCredibility()</a></p>
<p>examples:</p>
<p>curl:</p>
<pre class="prettyprint source lang-bash"><code>$ curl -X GET 'https://dingsda.org:3000/api/v1?name=jan&password=demopassword'</code></pre><p>client js/jquery:</p>
<pre class="prettyprint source lang-js"><code>var settings = {
  &quot;url&quot;: &quot;https://dingsda.org:3000/api/v1?name=jan&password=demopassword&quot;,
  &quot;method&quot;: &quot;GET&quot;,
  &quot;headers&quot;: {
    &quot;Content-Type&quot;: &quot;application/json&quot;,
    &quot;cache-control&quot;: &quot;no-cache&quot;,
  },
  &quot;data&quot;: &quot;&quot;
}

$.ajax(settings).done(function (response) {
  console.log(response);
});</code></pre><p>python:</p>
<pre class="prettyprint source lang-python"><code>import requests

url = &quot;https://dingsda.org:3000/api/v1&quot;

querystring = {&quot;name&quot;:&quot;jan&quot;,&quot;password&quot;:&quot;demopassword&quot;}

payload = &quot;&quot;
headers = {
    'Content-Type': &quot;application/json&quot;,
    'cache-control': &quot;no-cache&quot;
    }

response = requests.request(&quot;GET&quot;, url, data=payload, headers=headers, params=querystring)

print(response.text)</code></pre><hr>
<h4>POST:</h4><h6>SEARCH:</h6><p>(CURRENTLY NOT USED. SEE dingslevel/findItems)</p>
<pre class="prettyprint source lang-json"><code>{
  &quot;type&quot;:&quot;search&quot;,
  &quot;doc&quot;: {...}
}</code></pre><p>see: <a href="https://dingsda.org/docs/global.html#search">search()</a></p>
<p>examples:
(...)</p>
<hr>
<h3>2. Database Level API</h3><h4>GET:</h4><h6>DB Infos:</h6><p><em>returns:</em>  CouchDB Infos about DB.</p>
<p><em>note:</em> for testing. probably to be deprecated later.</p>
<hr>
<h4>POST:</h4><hr>
<h6>ADD ITEMS</h6><p><em>json</em>:</p>
<pre class="prettyprint source lang-json"><code>&quot;data&quot;:[
  {
    &quot;type&quot;:&quot;addItems&quot;,
    &quot;doc&quot;: {&lt;doc to be added>}
  }
]</code></pre><table>
<thead>
<tr>
<th>parameter</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>doc</td>
<td>doc to be added.</td>
</tr>
</tbody>
</table>
<p>see: <a href="https://dingsda.org/docs/global.html#addItem">addItem()</a></p>
<p><strong>behaviour:</strong></p>
<hr>
<h6>UPDATE ITEMS</h6><p><em>json</em>:</p>
<pre class="prettyprint source lang-json"><code>&quot;data&quot;:[
  {
    &quot;type&quot;:&quot;updateItems&quot;,
    &quot;doc&quot;: {&lt;doc to be updated>}
  }
]</code></pre><table>
<thead>
<tr>
<th>parameter</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>doc</td>
<td>doc to be updated, including recent _rev(!)</td>
</tr>
</tbody>
</table>
<p>see: <a href="https://dingsda.org/docs/global.html#update">update()</a></p>
<p><strong>behaviour:</strong></p>
<p>updates item handed over in doc. needs to provide the most recent</p>
<hr>
<h6>DELETE ITEMS</h6><p><em>json</em>:</p>
<pre class="prettyprint source lang-json"><code>&quot;data&quot;:[
  {
    &quot;type&quot;:&quot;deleteItems&quot;,
    &quot;doc&quot;: {&lt;doc to be deleted>}
  }
]</code></pre><table>
<thead>
<tr>
<th>parameter</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>doc</td>
<td>doc to be deleted, including recent _rev(!)</td>
</tr>
</tbody>
</table>
<p>see: <a href="https://dingsda.org/docs/global.html#deleteItems">deleteItems()</a></p>
<p><strong>behaviour:</strong></p>
<hr>
<h6>FIND ITEMS</h6><p><em>json</em>:</p>
<pre class="prettyprint source lang-json"><code>&quot;data&quot;:[
  {
    &quot;type&quot;:&quot;findItems&quot;,
    &quot;doc&quot;:&lt;mango style searchTerm>
  }
]</code></pre><table>
<thead>
<tr>
<th>parameter</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>doc</td>
<td>searchQuery: object w/ <code>{ key : searchvalue }</code></td>
</tr>
<tr>
<td>bookmark</td>
<td>(OPTIONAL) bookmark string from last result.</td>
</tr>
</tbody>
</table>
<p>see: <a href="https://dingsda.org/docs/global.html#update">update()</a></p>
<p><strong>behaviour:</strong>
 Will search Database for documents matching the searchterm(s) specified in json-field data.doc</p>
<p>This API will only simplify all requests to use either &quot;$regex&quot;:&quot;(?i)&quot; or &quot;$in&quot;: in front of the searchValue. So: Search for searchValue will be successfull if searchValue is in any way included (within array or as substring) inside doc.</p>
<p>Also: in order to keep the API flat, it uses a dot notation (parent.child) for requests deeper down the object tree (e.g. parent.child:&quot;hans&quot; instead of parent:{child:&quot;hans&quot;}) (also: s.example below)</p>
<p>If you want to search more DBs at once and/or make real [mango queries] (https://github.com/cloudant/mango) to dingsda, use the search API endpoint on instance Level.</p>
<p>The query response result is limited to a maximum of 50 found items.
The <strong>optional bookmark</strong> field can be added to follow up query in order to get the next 50 items returned. (see <a href="https://docs.couchdb.org/en/stable/api/database/find.html?highlight=bookmark">couchDBs find()</a> API for more details on bookmarks behaviour)</p>
<p><strong>returns:</strong>
JSON formatted list of objects matching the searchQuery, but only contains the following fields: &quot;_id&quot;,&quot;name&quot;,&quot;location&quot;,&quot;other&quot;,&quot;owners&quot;,&quot;hyperlink&quot;,&quot;inPossessionOf&quot;. For more Information about the objects, a FETCH on Dings level is recommended</p>
<p>examples:</p>
<p>client js/jquery:</p>
<pre class="prettyprint source lang-js"><code>var data =
{
    &quot;data&quot;:
    [{
        &quot;type&quot;:&quot;findItems&quot;,
        &quot;doc&quot;:{
                 &quot;location.address&quot;: &quot;India&quot;
            }
    }]
}

var settings = {
  &quot;url&quot;: &quot;https://dingsda.org:3000/api/v1/jan&quot;,
  &quot;method&quot;: &quot;POST&quot;,
  &quot;headers&quot;: {
    &quot;Content-Type&quot;: &quot;application/json&quot;
  },
  &quot;data&quot;: JSON.stringify(data)
}

$.ajax(settings).done(function (response) {
  console.log(response);
});</code></pre><p>---&gt;</p>
<pre class="prettyprint source lang-json"><code>{
    &quot;docs&quot;: [
        {
            &quot;_id&quot;: &quot;1e862072-b279-5b84-b0ed-98eca77e21db&quot;,
            &quot;name&quot;: &quot;Samsonite Rollkoffer carry-on&quot;,
            &quot;location&quot;: {
                &quot;address&quot;: &quot;jogishvari, Jogeshwari Road, Chamunda Colony, Amraiwadi, Ahmedabad, Gujarat 380026, India&quot;,
                &quot;latitude&quot;: &quot;22.258652&quot;,
                &quot;longitude&quot;: &quot;71.19238050000001&quot;
            },
            &quot;other&quot;: {
                &quot;tags&quot;: [
                    &quot;Tools&quot;,
                    &quot;Travel&quot;,
                    &quot;Reise&quot;
                ],
                &quot;visibility&quot;: [
                    &quot;public&quot;
                ],
                &quot;description&quot;: &quot;2 compartments&quot;,
                &quot;borrowable&quot;: &quot;not&quot;
            },
            &quot;owners&quot;: [
                &quot;jan&quot;
            ],
            &quot;hyperlink&quot;: &quot;https://dingsda.org:3000/api/v1/jan/1e862072-b279-5b84-b0ed-98eca77e21db&quot;
        }
    ],
    &quot;bookmark&quot;: &quot;g1AAAAB4eJzLYWBgYMpgSmHgKy5JLCrJTq2MT8lPzkzJBYqrGKZamBkZmBvpJhmZW-qaJlmY6CYZpKboWlqkJieam6caGaYkgfRywPQSrSsLAGuGH_M&quot;
}
</code></pre><hr>
<hr>
<h3>json schema (work in progress NOT UP TO DATE!!!)</h3><p>explanation needed for:</p>
<ul>
<li>location either string (then: constraint free because only for humans anyhow)
or object (than one of two constraints) are valid and force longitude and latitude via pattern
or the field &quot;inside_id&quot; to mark in which other item it can be found</li>
<li>other contains everything that is not absolutely needed for the simplest bare bone item (that includes: barcodes, prices, sizes, availablity etc.)</li>
</ul>
<pre class="prettyprint source lang-json"><code>{
  &quot;$id&quot;: &quot;https://dingsda.org/api/v1/item.json&quot;,
  &quot;description&quot;: &quot;Schema for an item within dingsda.org DB. Describes a thing in as minimal terms as possible&quot;,
  &quot;definitions&quot;: {
    &quot;location&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;description&quot;: &quot;minimal requirements for a location object.&quot;,
      &quot;properties&quot;: {
        &quot;name&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;address&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;longitude&quot;: {
          &quot;type&quot;: &quot;string&quot;,
          &quot;pattern&quot;: &quot;^(\\+|-)?(?:180(?:(?:\\.0{1,6})?)|(?:[0-9]|[1-9][0-9]|1[0-7][0-9])(?:(?:\\.[0-9]{1,6})?))$&quot;
        },
        &quot;latitude&quot;: {
          &quot;type&quot;: &quot;string&quot;,
          &quot;pattern&quot;: &quot;^(\\+|-)?(?:90(?:(?:\\.0{1,6})?)|(?:[0-9]|[1-8][0-9])(?:(?:\\.[0-9]{1,6})?))$&quot;
        },
        &quot;insideOf&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
      },
      &quot;required&quot;: [
        &quot;name&quot;,
        &quot;longitude&quot;,
        &quot;latitude&quot;
      ]
    }
  },
  &quot;type&quot;: &quot;object&quot;,
  &quot;properties&quot;: {
    &quot;_id&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;unique ID to identify item.&quot;
    },
    &quot;name&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;human readable name&quot;
    },
    &quot;location&quot;: {
      &quot;type&quot;: [
        &quot;string&quot;,
        &quot;object&quot;
      ],
      &quot;oneOf&quot;: [
        {
          &quot;$ref&quot;: &quot;#/definitions/location&quot;
        },
        {
          &quot;$ref&quot;: &quot;#/definitions/obj_in_obj&quot;
        },
        {
          &quot;type&quot;: &quot;string&quot;
        }
      ],
      &quot;description&quot;: &quot;physical location of the object at the moment. either string describing location or object following location definition.&quot;
    },
    &quot;owners&quot;: {
      &quot;type&quot;: [
        &quot;string&quot;,
        &quot;array&quot;
      ]
    },
    &quot;other&quot;: {
      &quot;$id&quot;: &quot;/properties/other&quot;,
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;price&quot;: {
          &quot;$id&quot;: &quot;/properties/other/properties/price&quot;,
          &quot;type&quot;: &quot;string&quot;,
          &quot;title&quot;: &quot;The Price Schema &quot;
        },
        &quot;visibility&quot;: {
          &quot;$id&quot;: &quot;/properties/other/properties/visibility&quot;,
          &quot;type&quot;: [
            &quot;string&quot;,
            &quot;array&quot;
          ]
          &quot;title&quot;: &quot;Read Rights for this item&quot;,
          &quot;description&quot;: &quot;needs to be either keywords 'private', 'public' or an Array of groups listed in _security of owners DB&quot;
        }
      }
    }
  },
  &quot;required&quot;: [
    &quot;_id&quot;,
    &quot;name&quot;,
    &quot;location&quot;,
    &quot;owners&quot;
  ]
}</code></pre><p>this simple example would pass validation:</p>
<pre class="prettyprint source lang-json"><code>{
    &quot;_id&quot;:&quot;1&quot;,
    &quot;name&quot;:&quot;eins&quot;,
    &quot;location&quot;:{&quot;name&quot;:&quot;berlin&quot;,&quot;longitude&quot;:&quot;52.51704&quot;,&quot;latitude&quot;:&quot;13.38792&quot;},
    &quot;owner&quot;:[&quot;machinaex&quot;],
    &quot;other&quot;:{}
}</code></pre></article>
    </section>






</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#addContainerOfDoc">addContainerOfDoc</a></li><li><a href="global.html#addHyperlink2Doc">addHyperlink2Doc</a></li><li><a href="global.html#addItem">addItem</a></li><li><a href="global.html#addToArrayIfNotExist">addToArrayIfNotExist</a></li><li><a href="global.html#addToInMyPossession">addToInMyPossession</a></li><li><a href="global.html#arrayItemfoundInArray">arrayItemfoundInArray</a></li><li><a href="global.html#borrow_request">borrow_request</a></li><li><a href="global.html#compareArrays">compareArrays</a></li><li><a href="global.html#couch_getUserDB">couch_getUserDB</a></li><li><a href="global.html#DBCommander">DBCommander</a></li><li><a href="global.html#deleteContainerOf">deleteContainerOf</a></li><li><a href="global.html#deleteFromInMyPossession">deleteFromInMyPossession</a></li><li><a href="global.html#deleteItemCopies">deleteItemCopies</a></li><li><a href="global.html#deleteItems">deleteItems</a></li><li><a href="global.html#dingsCommander">dingsCommander</a></li><li><a href="global.html#fetch">fetch</a></li><li><a href="global.html#findItems">findItems</a></li><li><a href="global.html#fromHex">fromHex</a></li><li><a href="global.html#getCarnet">getCarnet</a></li><li><a href="global.html#getSessionAndAuthToken">getSessionAndAuthToken</a></li><li><a href="global.html#getTargetsFromUrl">getTargetsFromUrl</a></li><li><a href="global.html#handover">handover</a></li><li><a href="global.html#handover_announce">handover_announce</a></li><li><a href="global.html#handover_cancel">handover_cancel</a></li><li><a href="global.html#handover_deny">handover_deny</a></li><li><a href="global.html#insertItemCopies">insertItemCopies</a></li><li><a href="global.html#instanceCommander">instanceCommander</a></li><li><a href="global.html#makeMango">makeMango</a></li><li><a href="global.html#move">move</a></li><li><a href="global.html#search">search</a></li><li><a href="global.html#toHex">toHex</a></li><li><a href="global.html#trimFloatStringToNDecimalPlaces">trimFloatStringToNDecimalPlaces</a></li><li><a href="global.html#trimTrailingSlashes">trimTrailingSlashes</a></li><li><a href="global.html#update">update</a></li><li><a href="global.html#updateContainerOf">updateContainerOf</a></li><li><a href="global.html#updatePublicDBIfPublic">updatePublicDBIfPublic</a></li><li><a href="global.html#validateReadRights">validateReadRights</a></li><li><a href="global.html#verifyAuthToken">verifyAuthToken</a></li><li><a href="global.html#verifyByJsonPW">verifyByJsonPW</a></li><li><a href="global.html#verifyByUrlPW">verifyByUrlPW</a></li><li><a href="global.html#verifyUserCredibility">verifyUserCredibility</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Thu Jan 17 2019 12:08:36 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>