<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
      Home - Documentation
  </title>

  <link href="https://www.braintreepayments.com/images/favicon-ccda0b14.png" rel="icon" type="image/png">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

  <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
  <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
  

  

  <!-- start Mixpanel -->
  <script type="text/javascript">(function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("1919205b2da72e4da3b9b6639b444d59");</script>
  <!-- end Mixpanel -->
</head>

<body>
  <svg style="display: none;">
    <defs>
      <symbol id="linkIcon" fill="#706d77" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
          <path d="M0 0h24v24H0z" fill="none"/>
          <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/>
      </symbol>
    </defs>
  </svg>

  <input type="checkbox" id="nav-trigger" class="nav-trigger" />
  <label for="nav-trigger" class="navicon-button x">
    <div class="navicon"></div>
  </label>

  <label for="nav-trigger" class="overlay"></label>

  <div class="top-nav-wrapper">
    <ul>
      <li  class="active" >
        <a href="index.html">
          
          
            <svg fill="#0095dd" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
              <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
              <path d="M0 0h24v24H0z" fill="none"/>
            </svg>
          
        </a>
      </li>

      

    </ul>
  </div>

  <nav>
    <h3 class="reference-title">
      Braintree SDK Client Reference
    </h3>

    

    <h3 id="global-nav">Global</h3><ul><li><a href="global.html#addContainerOfDoc">addContainerOfDoc</a></li><li><a href="global.html#addHyperlink2Doc">addHyperlink2Doc</a></li><li><a href="global.html#addItem">addItem</a></li><li><a href="global.html#addToArrayIfNotExist">addToArrayIfNotExist</a></li><li><a href="global.html#addToInMyPossession">addToInMyPossession</a></li><li><a href="global.html#arrayItemfoundInArray">arrayItemfoundInArray</a></li><li><a href="global.html#borrow_request">borrow_request</a></li><li><a href="global.html#checkIfContainerOfUpdate">checkIfContainerOfUpdate</a></li><li><a href="global.html#compareArrays">compareArrays</a></li><li><a href="global.html#copyGeoDataFromContainerToAllItemsInside">copyGeoDataFromContainerToAllItemsInside</a></li><li><a href="global.html#couch_getUserDB">couch_getUserDB</a></li><li><a href="global.html#DBCommander">DBCommander</a></li><li><a href="global.html#deleteContainerOf">deleteContainerOf</a></li><li><a href="global.html#deleteFromInMyPossession">deleteFromInMyPossession</a></li><li><a href="global.html#deleteItemCopies">deleteItemCopies</a></li><li><a href="global.html#deleteItems">deleteItems</a></li><li><a href="global.html#dingsCommander">dingsCommander</a></li><li><a href="global.html#fetch">fetch</a></li><li><a href="global.html#findItems">findItems</a></li><li><a href="global.html#fromHex">fromHex</a></li><li><a href="global.html#getCarnet">getCarnet</a></li><li><a href="global.html#getGeoDataFromContainer">getGeoDataFromContainer</a></li><li><a href="global.html#getNotificationsAsAdmin">getNotificationsAsAdmin</a></li><li><a href="global.html#getSessionAndAuthToken">getSessionAndAuthToken</a></li><li><a href="global.html#getTargetsFromUrl">getTargetsFromUrl</a></li><li><a href="global.html#handover">handover</a></li><li><a href="global.html#handover_announce">handover_announce</a></li><li><a href="global.html#handover_cancel">handover_cancel</a></li><li><a href="global.html#handover_deny">handover_deny</a></li><li><a href="global.html#insertItemCopies">insertItemCopies</a></li><li><a href="global.html#instanceCommander">instanceCommander</a></li><li><a href="global.html#makeMango">makeMango</a></li><li><a href="global.html#move">move</a></li><li><a href="global.html#pushRegister">pushRegister</a></li><li><a href="global.html#pushSend">pushSend</a></li><li><a href="global.html#search">search</a></li><li><a href="global.html#sendPushToUser">sendPushToUser</a></li><li><a href="global.html#toHex">toHex</a></li><li><a href="global.html#trimFloatStringToNDecimalPlaces">trimFloatStringToNDecimalPlaces</a></li><li><a href="global.html#trimTrailingSlashes">trimTrailingSlashes</a></li><li><a href="global.html#update">update</a></li><li><a href="global.html#updateContainerOf">updateContainerOf</a></li><li><a href="global.html#updatePublicDBIfPublic">updatePublicDBIfPublic</a></li><li><a href="global.html#validateReadRights">validateReadRights</a></li><li><a href="global.html#verifyAuthToken">verifyAuthToken</a></li><li><a href="global.html#verifyByJsonPW">verifyByJsonPW</a></li><li><a href="global.html#verifyByUrlPW">verifyByUrlPW</a></li><li><a href="global.html#verifyUserCredibility">verifyUserCredibility</a></li></ul>
  </nav>

  <div id="main">
    

    
      



    

      


  <section class="readme">
    <article>
      <h1>dingsda</h1><p>dingsda - ze internez of dings</p>
<p>https://<a href="http://www.dingsda.org">www.dingsda.org</a></p>
<p>test web UI (optimized for mobile): https://<a href="http://www.dingsda.org/two">www.dingsda.org/two</a></p>
<p>at the moment: invite only. Feel welcome to contact philip(_Ã¤t_)machinaex(<em>dot</em>)de to get a test account.</p>
<h2>documentation</h2><p>function documentation (so far only of server.js not yet from the clients) can
be found at https://dingsda.org/docs/</p>
<p>visual schematic documentation of the client - server - database flows and (later)
the livecycle of an HTTP request against the dingsda API can be found further down at <a href="#markdown-header-schemata">schemata</a></p>
<h2>API v0.1 (server.js)</h2><p>HTTP API running from node script:</p>
<p> <em>server.js</em>:</p>
<p>the list of API endpoints and functions is found below at: <a href="#markdown-header-http-api-reference">HTTP API REFERENCE</a></p>
<p><strong>known issues</strong></p>
<ul>
<li>not proper RESTful API because commands part of JSON payload instead of url endpoint. will be changed till v1.0.0, but atm not hightest priority (sorry, noob mistake)</li>
</ul>
<p><strong>dependencies:</strong></p>
<ul>
<li><a href="https://github.com/apache/couchdb-nano">nano (^7.1.0)</a></li>
<li><a href="https://www.npmjs.com/package/https">https (^1.0.0)</a></li>
<li><a href="https://github.com/expressjs/express">express (^4.16.4)</a></li>
<li><a href="https://github.com/request/request">request (^2.88.0)</a></li>
<li><a href="https://github.com/expressjs/cookie-parser">cookie-parser (^1.4.3)</a></li>
<li><a href="https://github.com/expressjs/body-parser">body-parser (^1.18.3)</a></li>
<li><a href="https://github.com/kelektiv/node-uuid">uuid/v5 (^3.3.2)</a></li>
<li><a href="https://github.com/expressjs/cors">cors (^2.8.4)</a></li>
<li><a href="https://github.com/nodejitsu/node-http-proxy">http-proxy (^1.17.0)</a></li>
<li><p><a href="https://github.com/sasaplus1/deepcopy.js">deepcopy ^1.0.0</a></p>
</li>
<li><p><a href="https://github.com/web-push-libs/web-push">web-push (^2.88.0)</a> (not yet implemented but used in pushServer_test)</p>
</li>
</ul>
<p><strong>configuration</strong></p>
<p>configuration for server.js and pushServer_test is to be found within the config_file server_config.json</p>
<p>configuration for the UIs is found inside of UI/<ui number>/config_UI.json</p>
<p>make sure to provide all necessary information before you start the server.</p>
<p><strong>HTTP API GENERAL STRUCTURE</strong></p>
<p>the dingsda API knows <strong>3 different entry levels / URL endpoints:</strong></p>
<ol>
<li><p><strong>Instance Level</strong> (http requests to URL instanceUrl + API_BASE_URL will be considered Instance Level and handled within server.js by the function <strong><a href="https://dingsda.org/docs/global.html#instanceCommander">instanceCommander()</a></strong>)</p>
<p>for example: https://dingsda.org:3000/api/v1
This level is mainly to manage user Authentication, login, subscriptions etc</p>
</li>
<li><p><strong>Database Level</strong> (http requests to URL instanceUrl + API_BASE_URL + <em>username</em> will be considered DB level and handled by function <strong><a href="https://dingsda.org/docs/global.html#DBCommander">DBCommander()</a></strong>)</p>
<p>for example: https://dingsda.org:3000/api/v1/machinaex
This level is the server endpoint users will interact the most with, as it represents the user's
database and handles all requests that do concern more than one item. This also means: It will only be
relevant for the user owning the DB addressed</p>
</li>
<li><p><strong>Ding Level</strong> (http requests to URL instanceURL + API_BASE_URL + <username> + <item _id> will be considered dinglevel and be handled by function <strong><a href="https://dingsda.org/docs/global.html#dingsCommander">dingsCommander()</a></strong>)</p>
<p>for example: https://dingsda.org:3000/api/v1/machinaex/29e5cf8f-a99c-571c-93ab-e24fad18d2be
This level is only handling requests that aim for single items in a database. It usually concerns owners
of the item and people who the item is shared with or anyone who is allowed to read the items info (e.g.
if it is set to be publicly visible)</p>
</li>
</ol>
<p>requests to API need AuthSessionToken within its cookies all times except for Authentication.</p>
<p>Important: <strong>All POST API endpoints</strong> MUST be <strong>JSON formatted</strong> and follow this
basic form:</p>
<pre class="prettyprint source lang-json"><code>{
  &quot;data&quot;:[
    {
      &quot;type&quot;:&quot;&lt;name of command type>&quot;,
      &quot;&lt;other fields>&quot;: {}
    }
  ]
}</code></pre><p><strong>HTTP API REFERENCE</strong></p>
<div id="markdown-header-http-api-reference">

<h4>Authentication:</h4><p><em>endpoint:</em>
<code>/api/v1/</code></p>
<p><em>GET:</em></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>username to authenticate with</td>
</tr>
<tr>
<td>password</td>
<td>password</td>
</tr>
</tbody>
</table>
<p>see: <a href="https://dingsda.org/docs/global.html#verifyUserCredibility">verifyUserCredibility()</a></p>
<p><strong>behavior:</strong></p>
<p>verifies user Auth by testing for username and password inside of request query parameter.</p>
<p>username and password can be query parameters or in json format inside of a query parameter calles json.</p>
<p>e.g.:</p>
<p><code>https://xxx.xxx/yyy?username=aaa&amp;password=bbb</code> or</p>
<p><code>https://xxx.xxx/yyy?json='{&quot;username&quot;:&quot;aaa&quot;,&quot;password&quot;:&quot;bbb&quot;}'</code></p>
<p>response: AuthSessionCookie that can and will be saved by the browser</p>
<p>examples:</p>
<p>curl:</p>
<pre class="prettyprint source lang-bash"><code>$ curl -X GET 'https://dingsda.org:3000/api/v1?name=jan&password=demopassword'</code></pre><hr>
<h6>ADD ITEMS</h6><p><em>endpoint:</em>
<code>/api/v1/&lt; databasename &gt;</code></p>
<p><em>POST:</em></p>
<p><em>json</em>:</p>
<pre class="prettyprint source lang-json"><code>&quot;data&quot;:[
  {
    &quot;type&quot;:&quot;addItems&quot;,
    &quot;doc&quot;: {&lt;doc to be added>}
  }
]</code></pre><table>
<thead>
<tr>
<th>parameter</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>doc</td>
<td>doc to be added.</td>
</tr>
</tbody>
</table>
<p>see: <a href="https://dingsda.org/docs/global.html#addItem">addItem()</a></p>
<p><strong>behavior:</strong></p>
<p>adds item described fully in .doc to database defined by url endpoint</p>
<hr>
<h6>UPDATE ITEMS</h6><p><em>endpoint:</em>
<code>/api/v1/&lt; databasename &gt;</code></p>
<p><em>POST:</em></p>
<p><em>json</em>:</p>
<pre class="prettyprint source lang-json"><code>&quot;data&quot;:[
  {
    &quot;type&quot;:&quot;updateItems&quot;,
    &quot;doc&quot;: {&lt;doc to be updated>}
  }
]</code></pre><table>
<thead>
<tr>
<th>parameter</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>doc</td>
<td>doc to be updated, including recent _rev(!)</td>
</tr>
</tbody>
</table>
<p>see: <a href="https://dingsda.org/docs/global.html#update">update()</a></p>
<p><strong>behavior:</strong></p>
<p>updates item handed over in doc. needs to provide the most recent</p>
<hr>
<h6>DELETE ITEMS</h6><p><em>endpoint:</em>
<code>/api/v1/&lt; databasename &gt;</code></p>
<p><em>POST:</em></p>
<p><em>json</em>:</p>
<pre class="prettyprint source lang-json"><code>&quot;data&quot;:[
  {
    &quot;type&quot;:&quot;deleteItems&quot;,
    &quot;doc&quot;: {&lt;doc to be deleted; needs at least fields _id and _rev>}
  }
]</code></pre><table>
<thead>
<tr>
<th>parameter</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>doc</td>
<td>doc to be deleted, including recent _rev(!)</td>
</tr>
</tbody>
</table>
<p>see: <a href="https://dingsda.org/docs/global.html#deleteItems">deleteItems()</a></p>
<p><strong>behavior:</strong></p>
<p>deletes the item specified in json from the database specified in url if user has write permissions for database</p>
<hr>
<h6>GET SINGLE ITEM / GET THING</h6><p><em>endpoint:</em>
<code>/api/v1/&lt; databasename &gt;/&lt; thing _id &gt;</code></p>
<p><em>GET</em></p>
<p>see: <a href="https://dingsda.org/docs/global.html#getSingleItem">getSingleItem()</a></p>
<p><strong>behavior:</strong></p>
<p>returns complete JSON of a single thing including all fields and a reference to possible. This is the most important API endpoint to get a single things from dingsda. Usually used after a search or find request</p>
<hr>
<h6>ANNOUNCE HANDOVER OF ITEM TO ANOTHER USER ( LENT OUT / RETURN)</h6><p><em>endpoint:</em>
<code>/api/v1/&lt; databasename &gt;/&lt; thing _id &gt;</code></p>
<p><em>POST</em></p>
<p><strong>json</strong>:</p>
<pre class="prettyprint source lang-json"><code>{
    &quot;data&quot;:
    [{
        &quot;type&quot;:&quot;handover_announce&quot;,
        &quot;username&quot;:&lt;username>
    }]
}</code></pre><table>
<thead>
<tr>
<th>parameter</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>username</td>
<td>name of user the thing should be handed over to</td>
</tr>
</tbody>
</table>
<p>see: <a href="https://dingsda.org/docs/global.html#handover_announce">handover_announce()</a></p>
<p><strong>behavior:</strong>
Sends a handover announcement to the server. this will write a notification to
the user the item was handed over to as well as a notification into the users own database.</p>
<p>Both notifications contain the references to this transaction that can be used to
either accept the handover or deny the handover (only user receiving the item can do that)
or to cancel the transaction (only the user lending out the item can do that).</p>
<p>To accept the handover, the alleged borrower needs to send a &quot;handover_confirm&quot; to their own
the server endpoint.</p>
<p>To deny the handover, the alleged borrower needs to send a &quot;handover_deny&quot; to their own
server endpoint.</p>
<p>To cancel the handover, the user lending out the item needs to send a &quot;handover_cancel&quot;
to their own server endpoint.</p>
<hr>
<h6>CONFIRM HANDOVER</h6><p><em>endpoint:</em>
<code>/api/v1/&lt; databasename &gt;</code></p>
<p><em>POST</em></p>
<p><strong>json</strong>:</p>
<pre class="prettyprint source lang-json"><code>{
  &quot;data&quot;:
        [{
          &quot;type&quot;:&quot;handover&quot;,
          &quot;ref&quot;:&lt; notification.ref from handover await notification >,
          &quot;from&quot;:&lt; username of user lending out the item >
        }]
}</code></pre><table>
<thead>
<tr>
<th>parameter</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>username</td>
<td>name of user the thing should be handed over to</td>
</tr>
<tr>
<td>ref</td>
<td>_id of the item handed over</td>
</tr>
<tr>
<td>from</td>
<td>name of user lending out the item to user sending this request</td>
</tr>
</tbody>
</table>
<p>see: <a href="https://dingsda.org/docs/global.html#handover">handover()</a></p>
<p><strong>behavior:</strong></p>
<p>confirms a pending handover of thing with _id specified in .ref. the lender,
identified by .from, must have already announced an items handover via handover_announce API (see above).</p>
<p>After this action will grant the user confirming limited write permission and full read permissions for the item (they will be able to change the items location only) (unless the owner of the item cancelled the handover in between).</p>
<p>The user borrowing the item will be noted inside of the items document .inPossessionOf field and a reference to the item will be placed into the users -inMyPossession database.</p>
<p>The pending handover notifications will be deleted from both participants -notifications DBs.</p>
<hr>
<h6>DENY HANDOVER</h6><p><em>endpoint:</em>
<code>/api/v1/&lt; databasename &gt;</code></p>
<p><em>POST</em></p>
<p><strong>json</strong>:</p>
<pre class="prettyprint source lang-json"><code>{
  &quot;data&quot;:
        [{
          &quot;type&quot;:&quot;handover_deny&quot;,
          &quot;ref&quot;:&lt; notification.ref from handover await notification >,
          &quot;from&quot;:&lt; username of user lending out the item >
        }]
}</code></pre><table>
<thead>
<tr>
<th>parameter</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>username</td>
<td>name of user the thing should be handed over to</td>
</tr>
<tr>
<td>ref</td>
<td>_id of the item handed over</td>
</tr>
<tr>
<td>from</td>
<td>name of user lending out the item to user sending this request</td>
</tr>
</tbody>
</table>
<p>see: <a href="https://dingsda.org/docs/global.html#handover_deny">handover_deny()</a></p>
<p><strong>behavior:</strong></p>
<p>denies a pending handover of thing with _id specified in .ref. the lender,
identified by .from, must have already announced an items handover via handover_announce API (see above).</p>
<p>After this an info notification about the denial will be placed in the things owner db and the pending handover notifications will be deleted from both participants -notifications DBs</p>
<hr>
<h6>CANCEL HANDOVER</h6><p><em>endpoint:</em>
<code>/api/v1/&lt; databasename &gt;</code></p>
<p><em>POST</em></p>
<p><strong>json</strong>:</p>
<pre class="prettyprint source lang-json"><code>{
  &quot;data&quot;:
        [{
          &quot;type&quot;:&quot;handover_cancel&quot;,
          &quot;ref&quot;:&lt; notification.ref from handover await notification >,
          &quot;from&quot;:&lt; username of user lending out the item >
        }]
}</code></pre><table>
<thead>
<tr>
<th>parameter</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>username</td>
<td>name of user the thing should be handed over to</td>
</tr>
<tr>
<td>ref</td>
<td>_id of the item handed over</td>
</tr>
<tr>
<td>from</td>
<td>name of user lending out the item to user sending this request</td>
</tr>
</tbody>
</table>
<p>see: <a href="https://dingsda.org/docs/global.html#handover_deny">handover_deny()</a></p>
<p><strong>behavior:</strong></p>
<p>cancels a pending handover of thing with _id specified in .ref.</p>
<p>the lender,identified by .from, must have already announced an items handover via handover_announce API (see above). cancelling can only be done by the borrower of a pending handover.</p>
<p>The pending handover notifications will be deleted from both participants -notifications DBs</p>
<hr>
<h6>SEARCH:</h6><p><em>endpoint:</em>
<code>/api/v1/</code></p>
<p><em>POST:</em></p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>db</td>
<td>name of database to perform search in</td>
</tr>
<tr>
<td>doc</td>
<td>couchDB mango query (see: [mango queries] (https://github.com/cloudant/mango) )</td>
</tr>
<tr>
<td>bookmark</td>
<td>(OPTIONAL) bookmark string from last result.</td>
</tr>
</tbody>
</table>
<p><strong>behavior:</strong></p>
<p>performs a search against db using real [mango queries] (https://github.com/cloudant/mango).</p>
<p>The query response result is limited to a maximum of 50 found items.
The <strong>optional bookmark</strong> field can be added to follow up query in order to get the next 50 items returned. (see <a href="https://docs.couchdb.org/en/stable/api/database/find.html?highlight=bookmark">couchDBs find()</a> API for more details on bookmarks behavior)</p>
<p><strong>returns:</strong> JSON with array .docs containing all items found:</p>
<p>JSON formatted list of objects matching the searchQuery, but only contains the following fields:</p>
<p>&quot;_id&quot;,&quot;name&quot;,&quot;location&quot;,&quot;other&quot;,&quot;owners&quot;,&quot;hyperlink&quot;,&quot;inPossessionOf&quot;.</p>
<p>For more Information about the objects, a FETCH against dings level endpoint (/api/v1/<db>/) is recommended</p>
<p>and .bookmark containing reference
to next 50 items found by this search.</p>
<p><strong>note:</strong> planned but not yet implemented: db parameter optional array of strings or string (atm only possiblity)</p>
<p>in order to search several databases at once and get a combined response.</p>
<p>if you need to do a more simplistic search you can also use <a href="https://dingsda.org/docs/global.html#find">search()</a></p>
<p><em>json</em>:</p>
<pre class="prettyprint source lang-json"><code>{
    &quot;data&quot;:[{
        &quot;type&quot;:&quot;search&quot;,
        &quot;db&quot;:&quot;public&quot;,
        &quot;doc&quot;: { &lt; couchDB Mango Search Query > },
    &quot;bookmark&quot;: &lt;bookmark string (OPTIONAL)>
    }]
}</code></pre><p>see: <a href="https://dingsda.org/docs/global.html#search">search()</a></p>
<p>examples:</p>
<p>curl:</p>
<pre class="prettyprint source lang-bash"><code>curl -X POST \
  https://dingsda.org:3000/api/v1/ \
  -H 'Content-Type: application/json' \
  -d '{
    &quot;data&quot;:[{
        &quot;type&quot;:&quot;search&quot;,
        &quot;db&quot;:&quot;machinaex&quot;,
        &quot;doc&quot;: {
        &quot;_id&quot;: {
           &quot;$not&quot;: {
              &quot;$regex&quot;: &quot;-containerOf&quot;
           }
        },
        &quot;$and&quot;: [
           {
              &quot;_id&quot;:{
                  &quot;$not&quot;: {
                     &quot;$regex&quot;: &quot;&|config_one&quot;
                  }
                }
           },
           {
               &quot;name&quot;:{
                   &quot;$regex&quot;:&quot;studio monitor&quot;

               }
           }
        ]
     }
    }]
}'</code></pre><hr>
<h6>GET DB Infos:</h6><p><em>endpoint:</em>
<code>/api/v1/&lt; databasename &gt;</code></p>
<p><em>GET:</em></p>
<p><strong>returns:</strong>  CouchDB Infos about DB.</p>
<p><strong>note:</strong> for testing. probably to be deprecated later.</p>
<hr>
<h6>FIND ITEMS</h6><p><em>endpoint:</em>
<code>/api/v1/&lt; databasename &gt;</code></p>
<p><em>POST:</em></p>
<p><em>json</em>:</p>
<pre class="prettyprint source lang-json"><code>&quot;data&quot;:[
  {
    &quot;type&quot;:&quot;findItems&quot;,
    &quot;doc&quot;:&lt;mango style searchTerm>
  }
]</code></pre><table>
<thead>
<tr>
<th>parameter</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>doc</td>
<td>searchQuery: object w/ <code>{ key : searchvalue }</code></td>
</tr>
<tr>
<td>bookmark</td>
<td>(OPTIONAL) bookmark string from last result.</td>
</tr>
</tbody>
</table>
<p>see: <a href="https://dingsda.org/docs/global.html#findItems">findItems()</a></p>
<p><strong>behavior:</strong>
 Will search Database for documents matching the searchterm(s) specified in json-field data.doc</p>
<p>This API will only simplify all requests to use either &quot;$regex&quot;:&quot;(?i)&quot; or &quot;$in&quot;: in front of the searchValue. So: Search for searchValue will be successfull if searchValue is in any way included (within array or as substring) inside doc.</p>
<p>Note: in order to keep the API flat, it uses a dot notation (parent.child) for requests deeper down the object tree (e.g. parent.child:&quot;hans&quot; instead of parent:{child:&quot;hans&quot;}) (also: s.example below)</p>
<p>If you want to search more DBs at once and/or make real [mango queries] (https://github.com/cloudant/mango) to dingsda, use the search API endpoint on instance Level.</p>
<p>The query response result is limited to a maximum of 50 found items.
The <strong>optional bookmark</strong> field can be added to follow up query in order to get the next 50 items returned. (see <a href="https://docs.couchdb.org/en/stable/api/database/find.html?highlight=bookmark">couchDBs find()</a> API for more details on bookmarks behavior)</p>
<p><strong>returns:</strong>
JSON formatted list of objects matching the searchQuery, but only contains the following fields: &quot;_id&quot;,&quot;name&quot;,&quot;location&quot;,&quot;other&quot;,&quot;owners&quot;,&quot;hyperlink&quot;,&quot;inPossessionOf&quot;. For more Information about the objects, a FETCH on Dings level is recommended</p>
<p>examples:</p>
<p>client js/jquery:</p>
<pre class="prettyprint source lang-js"><code>var data =
{
    &quot;data&quot;:
    [{
        &quot;type&quot;:&quot;findItems&quot;,
        &quot;doc&quot;:{
                 &quot;location.address&quot;: &quot;India&quot;
            }
    }]
}

var settings = {
  &quot;url&quot;: &quot;https://dingsda.org:3000/api/v1/jan&quot;,
  &quot;method&quot;: &quot;POST&quot;,
  &quot;headers&quot;: {
    &quot;Content-Type&quot;: &quot;application/json&quot;
  },
  &quot;data&quot;: JSON.stringify(data)
}

$.ajax(settings).done(function (response) {
  console.log(response);
});</code></pre><p>---&gt;</p>
<pre class="prettyprint source lang-json"><code>{
    &quot;docs&quot;: [
        {
            &quot;_id&quot;: &quot;1e862072-b279-5b84-b0ed-98eca77e21db&quot;,
            &quot;name&quot;: &quot;Samsonite Rollkoffer carry-on&quot;,
            &quot;location&quot;: {
                &quot;address&quot;: &quot;jogishvari, Jogeshwari Road, Chamunda Colony, Amraiwadi, Ahmedabad, Gujarat 380026, India&quot;,
                &quot;latitude&quot;: &quot;22.258652&quot;,
                &quot;longitude&quot;: &quot;71.19238050000001&quot;
            },
            &quot;other&quot;: {
                &quot;tags&quot;: [
                    &quot;Tools&quot;,
                    &quot;Travel&quot;,
                    &quot;Reise&quot;
                ],
                &quot;visibility&quot;: [
                    &quot;public&quot;
                ],
                &quot;description&quot;: &quot;2 compartments&quot;,
                &quot;borrowable&quot;: &quot;not&quot;
            },
            &quot;owners&quot;: [
                &quot;jan&quot;
            ],
            &quot;hyperlink&quot;: &quot;https://dingsda.org:3000/api/v1/jan/1e862072-b279-5b84-b0ed-98eca77e21db&quot;
        }
    ],
    &quot;bookmark&quot;: &quot;g1AAAAB4eJzLYWBgYMpgSmHgKy5JLCrJTq2MT8lPzkzJBYqrGKZamBkZmBvpJhmZW-qaJlmY6CYZpKboWlqkJieam6caGaYkgfRywPQSrSsLAGuGH_M&quot;
}
</code></pre><hr>
<hr>
<h2>UI v0.2 (UI/two)</h2><p>the UI uses jquerymobile as it's main framework and has several dependencies.</p>
<p>the UI is a webpage, optimized for mobile use, designed to work as well as a fullscreen WebApp/PWA.</p>
<p>it also provides a (not finished but sorta working) table/spreadsheet view that is intended to be used mainly on a desktop computer, but works partially as well mobile.</p>
<p>an active demo UI can be found at https://<a href="http://www.dingsda.org/two">www.dingsda.org/two</a></p>
<p>screenshots and usage videos can be found at https://<a href="http://www.dingsda.org">www.dingsda.org</a></p>
<p>the complete UI code can be found within</p>
<ul>
<li>UI/two/index.html</li>
</ul>
<p>using the folders</p>
<ul>
<li>UI/two/assets</li>
<li>UI/two/css</li>
<li>UI/two/icons (partially used from the https://thenounproject.com please check licence note)</li>
<li>UI/two/manifest.json (if used as ProgressiveWebApp)</li>
</ul>
<p>in case you want to modify/contribute:</p>
<p>index.html is rendered with mustache (https://github.com/janl/mustache.js/) using the following files</p>
<ul>
<li>UI/two/base.html</li>
<li>UI/two/partials/*</li>
<li>UI/two/config_UI.json</li>
</ul>
<p>if you work on macOS, you can install fswatch (https://github.com/emcrisostomo/fswatch) and then use the helper bash script UI/two/renderOnChange.sh to render everytime a change happens within any of the partials.</p>
<p>otherwise just install mustache.js and render from commandline with command:</p>
<pre class="prettyprint source lang-bash"><code>mustache config_UI.json base.html index.html</code></pre><h4>dependencies:</h4><p>(atm all found within assets, but after refactoring will need install via npm or manual download)</p>
<p>basic dependencies for the UI webapp:</p>
<ul>
<li>jquery ^2.2.4 (https://jquery.com/)</li>
<li>jquery mobile 1.4.5 (https://jquerymobile.com/)</li>
<li>bootstrap-tagsinput (https://github.com/bootstrap-tagsinput/bootstrap-tagsinput)</li>
<li>dotize.js (https://github.com/vardars/dotize) (atm only version from UI/two/assets/dotize.js for it needed modification for dingsda. but dotizes author is already working on compatible version. see: https://github.com/vardars/dotize/issues/12 wishlist number 3.))</li>
<li>easy-autocomplete (https://github.com/pawelczak/EasyAutocomplete)</li>
<li>sweetalert2 (https://github.com/sweetalert2/sweetalert2/)</li>
<li>lazyload jquery 2.0.0 (https://github.com/tuupola/jquery_lazyload)</li>
</ul>
<p>for spreadsheet view with editable table:</p>
<ul>
<li>handsontable community edition (https://github.com/handsontable/handsontable)</li>
</ul>
<p>for barcode/QRcode reader in browser:</p>
<ul>
<li>quaggaJS (https://github.com/serratus/quaggaJS)</li>
<li>webrtc-adapter (https://github.com/webrtc/adapter)</li>
<li>zxing-js (https://github.com/zxing-js/library)</li>
</ul>
<p>for carnet A.T.A. custom form export functions:</p>
<ul>
<li>carnet.js (UI/two/assets/carnet.js)</li>
<li>SheetJS (https://github.com/SheetJS/js-xlsx)</li>
<li>jsPDF(https://github.com/MrRio/jsPDF)</li>
</ul>
<p>for the google maps plugin:</p>
<ul>
<li>jquery locationpicker (https://github.com/Logicify/jquery-locationpicker-plugin)</li>
<li>a googlemapsAPIkey (how to get one, see: https://developers.google.com/maps/documentation/javascript/get-api-key)</li>
</ul>
<hr>
<hr>
<p><div id="markdown-header-schemata"></p>
<h2>schemata</h2><p>you find different visual documentations of the data flow and the client - server / database
architecture of dingsda inside of /img</p>
<p>chema client-server-db:
<a href="https://drive.google.com/file/d/1pW1QeY8gtDGYSdhEBgnbmq6uOhYu_GGk/view?usp=sharing">schema client-server-db</a></p>
<p>templating flow and dependencies of client two:
<a href="https://drive.google.com/file/d/1Hj3rqdFng-oMDaZI2GvwObD1AM_WW8K2/view?usp=sharing">templating flow and dependencies of client two</a></p>
<hr>
<hr>
<h3>json schema (work in progress NOT UP TO DATE!!!)</h3><p>explanation needed for:</p>
<ul>
<li>location either string (then: constraint free because only for humans anyhow)
or object (than one of two constraints) are valid and force longitude and latitude via pattern
or the field &quot;inside_id&quot; to mark in which other item it can be found</li>
<li>other contains everything that is not absolutely needed for the simplest bare bone item (that includes: barcodes, prices, sizes, availablity etc.)</li>
</ul>
<pre class="prettyprint source lang-json"><code>{
  &quot;$id&quot;: &quot;https://dingsda.org/api/v1/item.json&quot;,
  &quot;description&quot;: &quot;Schema for an item within dingsda.org DB. Describes a thing in as minimal terms as possible&quot;,
  &quot;definitions&quot;: {
    &quot;location&quot;: {
      &quot;type&quot;: &quot;object&quot;,
      &quot;description&quot;: &quot;minimal requirements for a location object.&quot;,
      &quot;properties&quot;: {
        &quot;name&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;address&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
        &quot;longitude&quot;: {
          &quot;type&quot;: &quot;string&quot;,
          &quot;pattern&quot;: &quot;^(\\+|-)?(?:180(?:(?:\\.0{1,6})?)|(?:[0-9]|[1-9][0-9]|1[0-7][0-9])(?:(?:\\.[0-9]{1,6})?))$&quot;
        },
        &quot;latitude&quot;: {
          &quot;type&quot;: &quot;string&quot;,
          &quot;pattern&quot;: &quot;^(\\+|-)?(?:90(?:(?:\\.0{1,6})?)|(?:[0-9]|[1-8][0-9])(?:(?:\\.[0-9]{1,6})?))$&quot;
        },
        &quot;insideOf&quot;: {
          &quot;type&quot;: &quot;string&quot;
        },
      },
      &quot;required&quot;: [
        &quot;name&quot;,
        &quot;longitude&quot;,
        &quot;latitude&quot;
      ]
    }
  },
  &quot;type&quot;: &quot;object&quot;,
  &quot;properties&quot;: {
    &quot;_id&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;unique ID to identify item.&quot;
    },
    &quot;name&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;human readable name&quot;
    },
    &quot;location&quot;: {
      &quot;type&quot;: [
        &quot;string&quot;,
        &quot;object&quot;
      ],
      &quot;oneOf&quot;: [
        {
          &quot;$ref&quot;: &quot;#/definitions/location&quot;
        },
        {
          &quot;$ref&quot;: &quot;#/definitions/obj_in_obj&quot;
        },
        {
          &quot;type&quot;: &quot;string&quot;
        }
      ],
      &quot;description&quot;: &quot;physical location of the object at the moment. either string describing location or object following location definition.&quot;
    },
    &quot;owners&quot;: {
      &quot;type&quot;: [
        &quot;string&quot;,
        &quot;array&quot;
      ]
    },
    &quot;other&quot;: {
      &quot;$id&quot;: &quot;/properties/other&quot;,
      &quot;type&quot;: &quot;object&quot;,
      &quot;properties&quot;: {
        &quot;price&quot;: {
          &quot;$id&quot;: &quot;/properties/other/properties/price&quot;,
          &quot;type&quot;: &quot;string&quot;,
          &quot;title&quot;: &quot;The Price Schema &quot;
        },
        &quot;visibility&quot;: {
          &quot;$id&quot;: &quot;/properties/other/properties/visibility&quot;,
          &quot;type&quot;: [
            &quot;string&quot;,
            &quot;array&quot;
          ]
          &quot;title&quot;: &quot;Read Rights for this item&quot;,
          &quot;description&quot;: &quot;needs to be either keywords 'private', 'public' or an Array of groups listed in _security of owners DB&quot;
        }
      }
    }
  },
  &quot;required&quot;: [
    &quot;_id&quot;,
    &quot;name&quot;,
    &quot;location&quot;,
    &quot;owners&quot;
  ]
}</code></pre><p>this simple example would pass validation:</p>
<pre class="prettyprint source lang-json"><code>{
    &quot;_id&quot;:&quot;1&quot;,
    &quot;name&quot;:&quot;eins&quot;,
    &quot;location&quot;:{&quot;name&quot;:&quot;berlin&quot;,&quot;longitude&quot;:&quot;52.51704&quot;,&quot;latitude&quot;:&quot;13.38792&quot;},
    &quot;owner&quot;:[&quot;machinaex&quot;],
    &quot;other&quot;:{}
}</code></pre>
    </article>
  </section>


    


  </div>

  <br class="clear">

  <footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a>
  </footer>

  <script src="scripts/linenumber.js"></script>
  <script src="scripts/pagelocation.js"></script>

  

</body>
</html>